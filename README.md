this is the core file from master branch      
this is change from Release3

